repos:
  - repo: https://github.com/golangci/golangci-lint
    rev: v2.1.5
    hooks:
      - id: golangci-lint

  - repo: local
    hooks:
      - id: goreleaser-check
        name: goreleaser-check
        entry: goreleaser check
        language: system
        files: \.goreleaser\.yml$
        pass_filenames: false

      - id: diff-size-warning
        name: Diff size warning (>450 insertions)
        entry: >
          bash -c 'added=$(git diff main...HEAD --numstat
          -- . ":!*.md" ":!specs/**" ":!features/*.feature" ":!.specify/**" ":!.claude/**" |
          awk "{s+=\$1} END {print s+0}");
          if [ "$added" -gt 450 ]; then
          echo "âš ï¸  Warning: $added lines added compared to main (excluding docs/specs). Consider splitting into smaller PRs.";
          fi; exit 0'
        language: system
        always_run: true
        pass_filenames: false
        verbose: true

      - id: diff-size-limit
        name: Diff size limit (>1000 insertions)
        entry: >
          bash -c 'added=$(git diff main...HEAD --numstat
          -- . ":!*.md" ":!specs/**" ":!features/*.feature" ":!.specify/**" ":!.claude/**" |
          awk "{s+=\$1} END {print s+0}");
          if [ "$added" -gt 1000 ]; then
          echo "ðŸš« Error: $added lines added compared to main (excluding docs/specs). This exceeds the 1000-line limit. Split into smaller PRs.";
          exit 1; fi'
        language: system
        always_run: true
        pass_filenames: false
