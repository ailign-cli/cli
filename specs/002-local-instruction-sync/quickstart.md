# Quickstart: Local Instruction Sync

## Setup

### 1. Create instruction overlay files

```bash
mkdir -p .ai-instructions
```

Create `.ai-instructions/base.md`:
```markdown
# Project Instructions

- Use TypeScript with strict mode
- Follow the existing code style
- Write tests for all new code
```

Create `.ai-instructions/project-context.md`:
```markdown
# Project Context

This is a React application using Next.js 14 with App Router.
The database is PostgreSQL accessed via Prisma ORM.
```

### 2. Configure .ailign.yml

```yaml
targets:
  - claude
  - cursor
  - copilot
local_overlays:
  - .ai-instructions/base.md
  - .ai-instructions/project-context.md
```

### 3. Run sync

```bash
ailign sync
```

This will:
1. Compose the overlay files in order
2. Write the result to `.ailign/instructions.md` (the central hub)
3. Create symlinks from each target path to the hub file

### 4. Verify

```bash
ls -la .cursorrules
# lrwxr-xr-x  .cursorrules -> .ailign/instructions.md

ls -la .claude/instructions.md
# lrwxr-xr-x  .claude/instructions.md -> ../.ailign/instructions.md

cat .cursorrules
# <!-- DO NOT EDIT — Generated by ailign ... -->
# # Project Instructions
# ...
```

## Common Workflows

### Preview before syncing

```bash
ailign sync --dry-run
```

### Update instructions

Edit your overlay files, then re-sync:

```bash
vim .ai-instructions/base.md
ailign sync
```

Only the hub file is rewritten. Symlinks remain unchanged.

### Add a new target

Add the target to `.ailign.yml`:

```yaml
targets:
  - claude
  - cursor
  - copilot
  - windsurf    # added
```

Run sync to create the new symlink:

```bash
ailign sync
```

### JSON output for CI/CD

```bash
ailign sync --format json
```

### Check current config is valid

```bash
ailign validate
```

## File Structure After Sync

```
your-repo/
├── .ailign.yml                          # Config (you edit this)
├── .ailign/
│   └── instructions.md                  # Hub file (generated)
├── .ai-instructions/
│   ├── base.md                          # Overlay (you edit this)
│   └── project-context.md              # Overlay (you edit this)
├── .claude/
│   └── instructions.md -> ../.ailign/instructions.md
├── .cursorrules -> .ailign/instructions.md
└── .github/
    └── copilot-instructions.md -> ../../.ailign/instructions.md
```

## Git Integration

Both the hub file and symlinks should be committed to Git:

```bash
git add .ailign/instructions.md .claude/instructions.md \
       .cursorrules .github/copilot-instructions.md
git commit -m "chore: sync AI instructions via ailign"
```

This ensures other developers get working instruction files when
they clone the repository. The symlinks are stored by Git and
recreated on checkout (POSIX systems).

**Note**: Windows symlink support will be addressed in a future
feature. See spec assumptions for details.
